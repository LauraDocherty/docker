# Pacto Provider Proxy

Docker Image for [Pact Provider Proxy](https://github.com/bethesque/pact-mock_service).

It will test your provider against contract file passed to the provider generated by [pact-php-demo](https://github.com/mopoke/pact-php-demo) or [pacto](https://github.com/thoughtworks/pacto).

## Run it!

Create catalog /tmp/contract and `pact.json` file inside. `pact.json` file need to be pact contract file.  
Get your provider IP, which will be visible for `pact-provider-proxy`. If it is `http://localhost`, 
then pass `http://172.17.42.1:80` (it is your localhost machine docker virtual IP).
Pass it as environment variable API_ENDPOINT. 

    docker run -t --rm=true -e API_ENDPOINT="http://172.17.42.1:80" -v /tmp/contract:/contract madkom/pact-provider-proxy
    
Container returns `0` if testing went well. 
You can catch logs and reports, if mount volume `/opt/provider/log`, `/opt/provider/reports`



### Example pact contract file - `pact.json`
        
    {
      "consumer": {
        "name": "Alligator Consumer"
      },
      "provider": {
        "name": "Alligator Provider"
      },
      "interactions": [
        {
          "description": "a request for an alligator",
          "provider_state": "an alligator with the name Mary exists",
          "request": {
            "method": "get",
            "path": "/hello/world",
            "headers": {
              "Accept": "application/json"
            }
          },
          "response": {
            "status": 200,
            "headers": {
              "Content-Type": "application/json"
            },
            "body": {
              "faq": {
                "data" : "blah"
              }
            }
          }
        }
      ],
      "metadata": {
        "pactSpecificationVersion": "2.0.0"
      }
    }
    
